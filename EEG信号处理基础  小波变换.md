## EEG信号处理基础 | 小波变换

### 1、小波变换

​    小波变换是一种时频局部化的信号处理方法，小波变换适合于在低频变化缓慢和在高频变化较快的信号，它非常适合于局部瞬时事件，这种情况经常在癫痫发作时出现。由于小波的这种特征提取的特性，相关研究人员经常使用小波分析各种医学生物信号。

​    小波(wavelet)，即小区域的波，来源于小波母函数的单函数。小波函数的定义如下：若函数 $ \psi(t) $ 满足：
$$
\int_{-\infty}^{\infty}\psi(t)dt = 0
$$
则称 $ \psi(t)$ 为小波母函数或基本小波，将 $ \psi(t)$ 作傅里叶变换，得到了小波函数的容许性条件如下：
$$
\int_{R}\frac{|\Psi(\omega)|^2}{\omega}d{\omega}<\infty
$$
​    根据小波函数的容许性条件可知可知小波函数具有小和波动性的特点：”小“ 指小波函数在时域具有紧支集（这个函数的支集是有有限的子集覆盖的），“波动性” 指均值为0。

------

​    连续小波变换是小波变换的基础理论，连续小波变换的表达式如下：
$$
WT_f(a,b)=<f(t),\psi_{a,b}(t)>=\frac{1}{\sqrt{a}}\int_{R}f(t)\overline{\psi(\frac{t-b}{a})}dt
$$
​    其中 $<x,y> $ 表示内积，$a$ 为尺度参数， $ b$ 为平移参数， $ L^{2}(R)$ 表示平方可积的函数空间即为距离空间，具体表达式为：
$$
L^{2}(R)=\begin{Bmatrix}x(t):\int_{R}|x(t)|^{2}dt<\infty\end{Bmatrix}
$$
​    在多数情况下，小波母函数被认为是连续有限的，因此连续小波变换存在于相比$ L^{2}(R)$ 空间更大的空间。如果母小波是有限的，那么小波变换的 $f\in{L^{1}(R)}$ ，称 $ WT_f(a,\tau)$ 为小波变换系数。

​    连续小波变换具有：时频性、叠加性、时移性、内积性、能量守恒性、再生性。

​    为了能够进行数字化数据处理，将参数 $a$ 和 $b$ 进行离散化处理：设 $a$ , $ b$ 两个参数满足： $a=a_{0}^{m}$ ， $ b=a_{0}^{m}nb_{0}$ ，且 $a_0>1$ ，$b_0>0$ ，那么函数 $f$ 的离散小波变换为：
$$
f(m,n)=(W_f)(m,n)=\int_{-\infty}^{\infty}f(x)\overline{\psi_{m,n}(x)}dx
$$
其中
$$
\psi_{m,n}(x)=a_{0}^{-m/2}\psi(a_{0}^{-m}x-nb_{0})
$$
序列 $\sum_{m,n}^{\infty}{=}\ _{-\infty}\widetilde{f}(m,n)\psi_{m,n}(x)$ 称为函数 $f$ 的小波序列，函数{ $ \psi_{m,n}(x)$ }称为小波。一系列的$ \psi_{m,n}(x)$ 组成了平方可积的函数空间 $ L^{2}(R)$ 。

​    如果基底函数  $ \psi_{m,n}(x)$ 是正交的，那么原始信号可以从产生的小波系数准确无误的重构而不损失任何细节。因此，小波系数的个数与原始信号数据点的个数相同，即离散小波变换使用了一组正交基底函数舍弃了连续小波变换中的冗余信息。

------

​    多分辨率提供了一种有效计算离散小波变换的方法。在多分辨率分析中，平方可积的函数空间$ L^{2}(R)$ 被分解成一系列子空间 $W_{j}$ 的直和，其中 $j$ 的范围从 $-\infty$ 到 $+\infty$ ，其表示方法如下：
$$
L^{2}(R)={\cdots}W_{-3}{\oplus}W_{-2}{\oplus}W_{-1}{\oplus}W_{0}{\oplus}W_{1}{\oplus}W_{2}{\oplus}W_{3}{\cdots}
$$
其中 $\oplus$ 表示直和。如果对于所有 $j \in{Z}$ 闭子空间 $V_{j}$ 定义如下：
$$
V_{j}=W_{j+1}{\oplus}W_{j+2}{\oplus}W_{j+3}{\oplus}{\cdots}
$$
那么我们称子空间 $V_{j}$ 是平方可积的函数空间$ L^{2}(R)$ 的多分辨率近似。子空间 $V_{j}$ 可以由一个尺度函数   $ \phi_{j,k}(t)$ 放大和平移获得，这样一来，子空间 $ W_{j}$ 是子空间 $V_{j}$ 的正交补空间：
$$
V_{j-1}= V_{j}\oplus W_{j}，j\in{Z}
$$
最终得到了离散小波变换的多分辨率分解公式：
$$
f(t)=\sum_{k=-\infty}^{\infty}c_{k}{\phi}(t-k)+\sum_{j=-\infty}^{\infty}\sum_{k-\infty}^{\infty}d_{j,k}\psi(2^{j}t-k)
$$
其中 $\phi(\cdot)$ 是尺度函数， $d_{j,k}$ 是小波系数， $c_{k}$ 是尺度系数。公式右侧第一个项目表示原始函数的概貌的近似值，第二个项目表示原始函数的局部细节，小波系数 $d_{j,k}$ 乘以放大和平移的小波函数可以当做尺度 $j-1$ 和 $j$ 下的连续信号近似值之间的局部残留误差，并且尺度 $j$ 下的信号细节表示如下：
$$
r_{j}(k)=\sum_{k=-\infty}^{\infty}d_{j,k}\psi(2^{j}t-k)
$$

------

​    一种有效的的离散小波变换滤波器算法可以通过多分辨率分析获得。高通滤波器对应小波函数$\psi_{j,k}(t)$ ，保留了信号的细节；低通滤波器对应尺度函数 $\phi_{j,k}(t)$ ，表示信号的粗略信息。在离散小波变换滤波器中，信号与高通滤波器做卷积得到细节参数，与低通滤波器做卷积得到形状近似的尺度系数。低通滤波器的截止频率 $g(n)$ 和高通滤波器的截止频率 $h(n)$ 等于采样率的四分之一。

​    在小波变换的第一步，输入信号同时通过低通滤波器和高通滤波器，他们的输出分别代表第一级的近似参数 $A1$ 和细节参数 $D1$ 。根据Nyquist定理，频带宽度等于原始信号一半的输出信号可以下采样。第一级输出的近似参数 $A1$ 继续通过低通滤波器和高通滤波器滤波，得到 $A2$ 和 $D2$ 。同样的方法可以得到下一级的近似参数和细节参数。在每一次的小波分解过程中，频率分辨率经过滤波后加倍，而时间分辨率经过下采样后减半。

<img src="EEG信号处理基础  小波变换.assets/v2-622ba04e18dc436cdfcb7276563f0951_r.jpg" alt="preview" style="zoom: 67%;" />

------

​    多贝西小波（Daubechies’  wavelet），SymN小波组及Meyer小波是常见的几种小波。其中Meyer小波具有紧支集和任意阶的正则性。多贝西小波简称dbN，是常使用的满足可容许条件的正交小波，他可以用小波系数重建原始信号。SymN小波组与dbN小波类似，但SymN小波具有较好的对称性，适用于图像处理。

<img src="EEG信号处理基础  小波变换.assets/image-20220110155828392.png" alt="image-20220110155828392" style="zoom: 67%;" />

------

### 2、小波能量

​    小波能量是将信号进行小波分解后计算出的细节参量的能量值，如果小波基函数是一组正交基函数，那么小波变换具有能量守恒的性质，具体可以由以下公式表示：
$$
\sum_{j}|W_{u}(j,k)|^{2}=||u||^{2}
$$
由此我们定义尺度 $j$ 下的小波能量为该尺度下重构信号 $D_{j}(k)$ 的平方和：
$$
E_{j}=\sum_{k}|D_{j}(k)^{2}|
$$
信号的总能量 $E_{t}$ 为所有尺度的小波能量的和：
$$
E_{t}=\sum_{j}\sum_{k}|D_{j}(k)^{2}|
$$

------

### 3、小结

​    小波变换对信号的很多特征提取特别地有效，比如信号的趋势、中断以及重复的模型，很多非平稳信号的分析常常应用小波变换。基于小波的时频分解这种信号处理方法常常应用到物体检测，特征提取以及时间尺度或空间尺度的分析。

​    EEG信号包含了很多非平稳瞬时事件，对这些时间序列信号分析的传统方法是傅里叶变换，傅里叶变换分析中无限基函数适合提取周期性、非瞬时性信号的频率特征，但是却不能捕捉信号的瞬时特征，我们也无法通过傅里叶变换系数观察信号的时频信息。

​    作为对比，小波变换是一种分析瞬时信号更为合适有效的方法，因为小波变换同时获得频率和时间的信息，长时间间隔的小波分析用于精确分析信号中的低频信息，短时间间隔的小波分析用于精确分析局部高频信息。如果小波基函数具有有限的区间，那么小波变换得到的频率信息具有时间局部性。因此相对于傅里叶变换，小波分析处理像EEG这种瞬时信号具有较大的优越性。

------

### 4、参考(Reference)

[1]宋焕荣. 癫痫脑电信号的提取和识别.大连理工大学[D]，2012.

[2]董旭阳. 基于EEG信号的癫痫发病预测的算法研究.哈尔滨工业大学，2015.

[3]王芳. 基于双树复小波变换的微弱生物医学信号处理及其研究应用[D].重庆大学，2014.

[4]Pathak R S.  The wavelet transform[M]. Springer Science & Business Media，2009:9-16.

[5]吴昊，肖先勇，沈睿佼. 小波能量谱和神经网络法识别雷击与短路故障[J]，高压电技术，2008,33(10):64-68.

